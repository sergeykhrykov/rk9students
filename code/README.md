# Устройство и сборка исходного кода проекта

## Устройство исходного кода

Весь исходный код расложен по папкам внутри директории ```src```. У каждого проекта своя папка, в которой должен лежать код только этого проекта (студенты не должны вносить изменения в чужие проекты). Кроме того, есть две особые папки:

* ```common``` - здесь располагается общая библиотека, которую можно подключать к своему проекту. Дополнять общую библиотеку может каждый, кто считает, что его код достаточно полезен для других участников
* ```sample_app``` - здесь вы найдете правильно настроенный пример проекта, который поможет вам настроить собственный проект. Вносить изменения в пример нельзя.

### Система сборки

С целью обеспечить высокую гибкость и кросс-плстформенность в репозитории используется система сборки CMake. Студенты также должны использовать CMake, интегрировав свой сценарий сборки в репозиторий. Использование других систем сборки (MSBuild, проекты Visual Studio) **не допускается**. Исключением на данный момент может служить только проект веб-приложения (```webapp```).

## Процедура сборки

Сборка всего кода в репозитории возможна с помощью всего нескольких команд. Находясь в каталоге ```code```, введите:

```
mkdir build
cd build
cmake .. -G"Visual Studio 14"
```

В папке build будет сгенерировано решение ```rk9works```, содержащее все проекты. Проекты студентов сгруппированы в раздел ```Apps```, а общая библиотека находится в разделе ```Libs```. Щелкните правой кнопкой мыши по проекту и выберите ```Build```, чтобы собрать его.

### Сборка общей библиотеки

Осуществляется так же, как сборка любого другого проекта. Особенность заключается в том, что если ваше приложение использует код из общей библиотеки (как, например, проект ```sample_app```), то при запуске вашего приложения могут быть не найдены скомпилированные файлы библиотеки. Решение заключается в том, чтобы собрать специальный проект под названием ```INSTALL```, который автоматически произведет установку нужных файлов в системные каталоги. После этого проблема исчезнет.

### Адаптация вашего проекта к системе сборки

Чтобы адаптировать свой проект, следует сначала внимательно изучить проект ```sample_app```. Обратите внимание на следующее:

* Как подключаются заголовочные файлы директивой ```#include```
* Изучите файл ```\src\sample_app\CMakeLists.txt```. 
* Изучите файл ```\src\CMakeLists.txt```. 
* Также обратите внимание на корневой файл ```CMakeLists.txt```, расположенный непосредственно в папке ```code```.

Разобравшись с тем, как устроена система сборки проекта ```sample_app```, приступите к созданию системы сборки для своего проекта. Рекомендуется скопировать содержимое этой папки в свой каталог, а затем произвести необходимые изменения в файлах:

* ```\src\ваш_проект\CMakeLists.txt```
* ```\src\CMakeLists.txt```


#Внимание!
> Не используйте средства управления проектами в Visual Studio! Добавление, удаление файлов в проект и прочие действия реализуются  **только** путем редактирования файлов ```CMakeLists.txt```. После внесения правок в любой из этих файлов система сборки обнаружит изменения и пересоздаст решение целиком. Вам останется только перезагрузить проект в Visual Studio, когда появится соответствующее окно.
Любые изменения, не отраженные в файлах ```CMakeLists.txt```, **будут потеряны**!

### Добавление тестов

_раздел находится в разработке_

### Добавление внешних файлов со входными данными (STL и т.п.)

_раздел находится в разработке_
